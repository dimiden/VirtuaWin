<HTML>
<HEAD>
<TITLE>External Interface</TITLE>
<META NAME="Author" CONTENT="Steven Phillips">
<META NAME="Generator" CONTENT="MicroEmacs JST">
</HEAD>
<BODY>
<P>   </P>

<P><H2>External Interface </H2></P>

<P>Most VirtuaWin commands and features can be accessed by sending windows messages to the <SPAN style="font-family: monospace">VirtuaWinMainClass</SPAN> window, this is also known as the Module interface. Any external program can locate this VirtuaWin window and send it commands, or use VirtuaWin's <B>-msg</B> command-line option, the format of this option is as follows:</P>

<DIR><P><SPAN style="font-family: monospace">VirtuaWin.exe -msg &lt;Msg&gt; &lt;wParam&gt; &lt;lParam&gt;</SPAN></P>

</DIR><P>Where <SPAN style="font-family: monospace">&lt;Msg&gt;</SPAN>, <SPAN style="font-family: monospace">&lt;wParam&gt;</SPAN> and <SPAN style="font-family: monospace">&lt;lParam&gt;</SPAN> are numbers as per the standard Windows SendMessage function. A complete and up-to-date list of supported messages can be found in Messages.h in the SDK package, the following list may not be fully up-to-date:</P>

<DIR><TABLE border=1 cellpadding=4 cellspacing=0>

<TR><TD valign=top>
<P><B>Msg</B></P></TD>
<TD valign=top>
<P><B>wParam</B></P></TD>
<TD valign=top>
<P><B>lParam</B></P></TD>
<TD valign=top>
<P><B>Description</B></P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>#</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to desktop #.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1025</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to previous desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1026</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1035</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop to the left.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1036</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop to the right.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1037</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop above.</P></TD></TR>
<TR><TD valign=top>
<P>1034</P></TD>
<TD valign=top>
<P>1038</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop below.</P></TD></TR>
<TR><TD valign=top>
<P>1039</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Exit VirtuaWin.</P></TD></TR>
<TR><TD valign=top>
<P>1040</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Open Setup dialog.</P></TD></TR>
<TR><TD valign=top>
<P>1041</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Remove VirtuaWin's systray icon. </P></TD></TR>
<TR><TD valign=top>
<P>1042</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Show VirtuaWin's systray icon. </P></TD></TR>
<TR><TD valign=top>
<P>1043</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Open VirtuaWin's on-line help. </P></TD></TR>
<TR><TD valign=top>
<P>1044</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Gather all windows onto the current desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1045</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns the width of the current layout, i.e. how many desktops wide.</P></TD></TR>
<TR><TD valign=top>
<P>1046</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns the depth of the current layout, i.e. how many desktops deep.</P></TD></TR>
<TR><TD valign=top>
<P>1048</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns the current desktop number.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>#</P></TD>
<TD valign=top>
<P>Move window to desktop #.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1025</P></TD>
<TD valign=top>
<P>Move window to previous desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1026</P></TD>
<TD valign=top>
<P>Move window to next desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1035</P></TD>
<TD valign=top>
<P>Move window to next desktop to the left.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1036</P></TD>
<TD valign=top>
<P>Move window to next desktop to the right.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1037</P></TD>
<TD valign=top>
<P>Move window to next desktop above.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1038</P></TD>
<TD valign=top>
<P>Move window to next desktop below.</P></TD></TR>
<TR><TD valign=top>
<P>1049</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>-#, -1025, ...</P></TD>
<TD valign=top>
<P>As with positive lParam values only VirtuaWin changes desktops as well, i.e. moves window and follows.</P></TD></TR>
<TR><TD valign=top>
<P>1050</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>-1</P></TD>
<TD valign=top>
<P>Toggle whether the window is shown on all desktops.</P></TD></TR>
<TR><TD valign=top>
<P>1050</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>0</P></TD>
<TD valign=top>
<P>Do not show window on all desktops.</P></TD></TR>
<TR><TD valign=top>
<P>1050</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>1</P></TD>
<TD valign=top>
<P>Show window on all desktops.</P></TD></TR>
<TR><TD valign=top>
<P>1051</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Give the window the focus, i.e. make it the foreground window.</P></TD></TR>
<TR><TD valign=top>
<P>1052</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Send the VirtuaWin installation path to <SPAN style="font-family: monospace">hWnd</SPAN> via a WM_COPYDATA message.</P></TD></TR>
<TR><TD valign=top>
<P>1053</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Send the VirtuaWin user configuration path to <SPAN style="font-family: monospace">hWnd</SPAN> via a WM_COPYDATA message.</P></TD></TR>
<TR><TD valign=top>
<P>1063</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>0</P></TD>
<TD valign=top>
<P>Access window - use method defined by 'On hidden window activation' setting.</P></TD></TR>
<TR><TD valign=top>
<P>1063</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>1</P></TD>
<TD valign=top>
<P>Access window - move to the current desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1063</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>2</P></TD>
<TD valign=top>
<P>Access window - shown on the current desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1063</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>3</P></TD>
<TD valign=top>
<P>Access window - change to the window's desktop.</P></TD></TR>
<TR><TD valign=top>
<P>1064</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns information about the window, see Messages.h for more information.</P></TD></TR>
<TR><TD valign=top>
<P>1065</P></TD>
<TD valign=top>
<P>?</P></TD>
<TD valign=top>
<P>?</P></TD>
<TD valign=top>
<P>Controls desktop thumbnail image generation, see Messages.h for more information.</P></TD></TR>
<TR><TD valign=top>
<P>1066</P></TD>
<TD valign=top>
<P>0</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns the current VirtuaWin running state (0 = disabled, 1 = enabled).</P></TD></TR>
<TR><TD valign=top>
<P>1066</P></TD>
<TD valign=top>
<P>1</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Toggles the current VirtuaWin running state, returns the previous state.</P></TD></TR>
<TR><TD valign=top>
<P>1066</P></TD>
<TD valign=top>
<P>2</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Disables VirtuaWin, returns the previous running state.</P></TD></TR>
<TR><TD valign=top>
<P>1066</P></TD>
<TD valign=top>
<P>3</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Enables VirtuaWin, returns the previous running state.</P></TD></TR>
<TR><TD valign=top>
<P>1067</P></TD>
<TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>#</P></TD>
<TD valign=top>
<P>Send the name of desktop # (or current desktop if # = 0) to <SPAN style="font-family: monospace">hWnd</SPAN> via a WM_COPYDATA message.</P></TD></TR>
<TR><TD valign=top>
<P>1068</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Returns the largest possible desktop number.</P></TD></TR>
<TR><TD valign=top>
<P>1069</P></TD>
<TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>Change to next desktop below.</P></TD></TR></TABLE>

</DIR><P><B>Where:</B></P>

<DIR><TABLE border=0 cellpadding=6 cellspacing=0>

<TR><TD valign=top>
<P>-</P></TD>
<TD valign=top>
<P>means not used (use a 0).</P></TD></TR>
<TR><TD valign=top>
<P>hWnd</P></TD>
<TD valign=top>
<P>Numeric handle to the window required.</P></TD></TR>
<TR><TD valign=top>
<P>hWnd or 0</P></TD>
<TD valign=top>
<P>Numeric handle to the window required or 0 for the window which currently has the focus.</P></TD></TR></TABLE>
</DIR></DIR>
</BODY>
</HTML>
